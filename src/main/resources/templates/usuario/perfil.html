<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil - iBike</title>
    <link th:href="@{/css/perfil.css}" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1>Meu Perfil</h1>
                <span class="role-badge" 
                      th:text="${usuario.status.name() == 'ADMIN'} ? 'Administrador' : 'Funcionário'">
                      Funcionário
                </span>
            </div>
            <a th:href="@{/home}" class="back-btn">Voltar ao Início</a>
        </div>

        <!-- Profile Card -->
        <div class="profile-card">
            <div class="profile-header">
                <div class="profile-avatar" th:text="${#strings.substring(usuario.nome,0,1).toUpperCase()}">U</div>
                <div class="profile-info">
                    <h2 th:text="${usuario.nome}">Nome do Usuário</h2>
                    <p>Informações do seu perfil</p>
                </div>
            </div>

            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Nome Completo</span>
                    <span class="info-value" th:text="${usuario.nome}">João Silva</span>
                </div>

                <div class="info-item">
                    <span class="info-label">Email</span>
                    <span class="info-value" th:text="${usuario.email}">joao.silva@ibike.com</span>
                </div>

                <div class="info-item">
                    <span class="info-label">Tipo de Acesso</span>
                    <span class="info-value" 
                          th:text="${usuario.status.name() == 'ADMIN'} ? 'Administrador' : 'Funcionário'">
                          Funcionário
                    </span>
                </div>

                <div class="info-item">
                    <span class="info-label">Pátio Atribuído</span>
                    <span class="info-value" 
                          th:text="${usuario.patio != null ? usuario.patio.nome : 'Não atribuído'}">
                          Pátio Central
                    </span>
                </div>
            </div>
        </div>

        <!-- Formulário de Edição -->
        <div class="edit-card">
            <h3>Editar Perfil</h3>
            <form th:action="@{/usuario/editar}" method="post">
                <label>Nome:</label>
                <input type="text" name="nome" th:value="${usuario.nome}" required>

                <label>Email:</label>
                <input type="email" name="email" th:value="${usuario.email}" required>

                <label>Pátio:</label>
                <select name="patioId">
                    <option th:each="patio : ${patios}" 
                            th:value="${patio.id}" 
                            th:text="${patio.nome}" 
                            th:selected="${usuario.patio != null} ? ${usuario.patio.id} == ${patio.id} : false">
                    </option>
                </select>

                <button type="submit">Salvar Alterações</button>
            </form>
        </div>

        <!-- Ações de Conta -->
        <div class="actions-card">
            <form th:action="@{/usuario/desativar}" method="post" style="display:inline;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn-desativar">Desativar Conta</button>
            </form>

            <form th:action="@{/logout}" method="post" style="display:inline;">
                <button type="submit" class="btn-logout">Sair</button>
            </form>
        </div>

        <!-- Navegação Rápida -->
        <h2 class="section-title">Navegação Rápida</h2>
        <div class="nav-grid">
            <a th:href="@{/home}" class="nav-card">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                    </svg>
                </div>
                <div class="nav-content">
                    <div class="nav-title">Página Inicial</div>
                    <div class="nav-description">Voltar ao dashboard</div>
                </div>
            </a>

            <a th:href="@{/motos}" class="nav-card">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                    </svg>
                </div>
                <div class="nav-content">
                    <div class="nav-title">Gerenciar Motos</div>
                    <div class="nav-description">Visualize e gerencie as motos</div>
                </div>
            </a>

            <a th:if="${usuario.status.name() == 'ADMIN'}" th:href="@{/patios}" class="nav-card">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                    </svg>
                </div>
                <div class="nav-content">
                    <div class="nav-title">Administrar Filiais</div>
                    <div class="nav-description">Gerencie todos os pátios</div>
                </div>
            </a>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>© 2025 iBike - Sistema de Monitoramento de Motos</p>
        </div>
    </div>
</body>
</html>
